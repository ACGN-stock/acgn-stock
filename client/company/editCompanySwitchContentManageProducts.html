<template name="editCompanySwitchContentManageProducts">
  <div class="d-flex flex-wrap align-items-center">
    <h4 class="mb-0 mr-2">
      待上架產品
    </h4>
    <button class="btn btn-sm btn-primary {{disabledOnFormVisibleClass}}" type="button" data-action="addProduct">
      <i class="fa fa-plus" aria-hidden="true"></i>
      新增
    </button>
  </div>
  <div class="my-2 d-flex flex-wrap">
    <div class="mr-3">生產資金：
      <div class="d-inline-flex flex-wrap">
        <span>已用 ${{currencyFormat usedProductionFund}}</span>
        <span class="mx-2">/</span>
        <span>剩餘 ${{currencyFormat availableProductionFund}}</span>
      </div>
    </div>
    <div class="mr-auto">產品價格上限：${{currencyFormat company.productPriceLimit}}</div>
  </div>

  {{#if isFormVisible}}
    <div class="my-3">
      {{> companyProductEditForm formArgs}}
    </div>
  {{/if}}

  <table class="mt-3 table table-sm table-bordered custom-responsive-table-md company-next-season-product">
    <thead>
      <tr>
        <th class="text-center text-truncate" title="產品">產品</th>
        <th class="text-center text-truncate" style="width: 60px;" title="類別">類別</th>
        <th class="text-center text-truncate" style="width: 60px;" title="分級">分級</th>
        <th class="text-center text-truncate" style="width: 60px;" title="價格">價格</th>
        <th class="text-center text-truncate" style="width: 60px;" title="數量">數量</th>
        <th class="text-center text-truncate" style="width: 60px;" title="補貨基準">補貨基準</th>
        <th class="text-center text-truncate" style="width: 60px;" title="補貨量">補貨量</th>
        <th class="text-center text-truncate" style="width: 60px;" title="管理">管理</th>
      </tr>
    </thead>
    <tbody>
      {{#each product in productList}}
        <tr>
          <td class="text-left" data-title="產品">
            <div class="product-name">
              {{#if isEditingProduct product._id}}
                <span class="product-editing-badge badge badge-sm badge-danger badge-pill">編輯中</span>
              {{/if}}
              <a href="{{product.url}}" title="{{product.productName}}" target="_blank">
                {{product.productName}}
              </a>
            </div>
            <div class="small my-2 product-description">
              {{product.description}}
            </div>
            <div class="small text-info">
              由 {{> userLink product.creator}} 於 {{formatDateTimeText product.createdAt}} 建立
            </div>
            {{#if product.updatedAt}}
              <div class="small text-info">
                由 {{> userLink product.updatedBy}} 於 {{formatDateTimeText product.updatedAt}} 進行最後更新
              </div>
            {{/if}}
          </td>
          {{#if isUntyped product.type}}
            <td class="text-center text-truncate text-nowrap align-middle text-warning" data-title="類別">
              {{product.type}}
            </td>
          {{else}}
            <td class="text-center text-truncate text-nowrap align-middle" data-title="類別">
              {{product.type}}
            </td>
          {{/if}}
          {{#if isRestrictedRating product.rating}}
            <td class="text-center text-truncate text-nowrap align-middle text-danger" data-title="分級">
              {{product.rating}}
            </td>
          {{else}}
            <td class="text-center text-truncate text-nowrap align-middle" data-title="分級">
              {{product.rating}}
            </td>
          {{/if}}
          <td class="text-center text-truncate text-nowrap align-middle" data-title="價格">
            ${{currencyFormat product.price}}
          </td>
          <td class="text-center text-truncate text-nowrap align-middle" data-title="數量">
            {{product.totalAmount}}
          </td>
          <td class="text-center text-truncate text-nowrap align-middle" data-title="補貨基準">
            {{productReplenishBaseAmountTypeDisplayName product.replenishBaseAmountType}}
          </td>
          <td class="text-center text-truncate text-nowrap align-middle" data-title="補貨量">
            {{productReplenishBatchSizeTypeDisplayName product.replenishBatchSizeType}}
          </td>
          <td class="text-center text-truncate text-nowrap align-middle" data-title="管理">
            <button class="btn btn-info btn-sm {{disabledOnFormVisibleClass}}" type="button" data-action="editProduct" data-product-id="{{product._id}}">
              <i class="fa fa-edit" aria-hidden="true"></i>
              編輯
            </button>
            <button class="btn btn-danger btn-sm" type="button" data-action="removeProduct" data-product-id="{{product._id}}">
              <i class="fa fa-trash" aria-hidden="true"></i>
              刪除
            </button>
          </td>
        </tr>
      {{else}}
        <tr class="default-content">
          <td class="text-center text-truncate p-1" colspan="8">目前沒有預定產品！</td>
        </tr>
      {{/each}}
    </tbody>
  </table>
</template>
